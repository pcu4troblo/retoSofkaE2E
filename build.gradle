buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath("net.serenity-bdd:serenity-gradle-plugin:2.2.12")

        classpath "net.serenity-bdd:serenity-single-page-report:2.2.12"
    }
}

plugins {
    id 'java'
    id 'jacoco'
    id 'idea'
    id 'eclipse'
    id 'org.sonarqube' version "3.3"
}

apply plugin: 'net.serenity-bdd.aggregator'

repositories {
    mavenCentral()
    mavenLocal()
}

compileJava.options.encoding = "UTF-8"
compileTestJava.options.encoding = "UTF-8"

ext {
    serenityVersion="2.2.12"
    serenityCucumberVersion="2.2.6"
}

wrapper {
    gradleVersion '6.5'
    distributionType Wrapper.DistributionType.ALL
}

//TODO ajustar dependencias con versiones actualizadas y eliminar dependencias que no apliquen al proyecto
dependencies {
    implementation "net.serenity-bdd:serenity-cucumber5:$serenityCucumberVersion"
    implementation "net.serenity-bdd:serenity-ensure:$serenityVersion"
    implementation "net.serenity-bdd:serenity-core:$serenityVersion"
    implementation "net.serenity-bdd:serenity-junit:$serenityVersion"
    implementation "net.serenity-bdd:serenity-screenplay:$serenityVersion"
    implementation "net.serenity-bdd:serenity-screenplay-webdriver:$serenityVersion"
    implementation "net.serenity-bdd:serenity-screenplay-rest:$serenityVersion"
    implementation "net.serenity-bdd:serenity-ensure:$serenityVersion"
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.10.3'
    implementation 'com.github.javafaker:javafaker:1.0.2'
    implementation 'junit:junit:4.13'
    implementation 'org.slf4j:slf4j-simple:1.7.30'
    implementation 'org.assertj:assertj-core:3.15.0'
    implementation 'io.rest-assured:rest-assured:4.3.3'
    testImplementation 'junit:junit:4.12'
    compileOnly fileTree (dir: 'libs', include: '*.jar')
}

//TODO ajustar parametros de task test con runners del proyecto
test {
    include "**/*TestRunner.class"
    exclude "**/RunnerExclueded*.class"
    testLogging.showStandardStreams = true
}
test.finalizedBy(aggregate)

sonarqube {
    properties {
        property "sonar.java.binaries", "src/main"
        property "sonar.exclusions", "**/*Generated.java, **/*Templates.java"
        property "sonar.coverage.jacoco.xmlReportPaths", "${buildDir}/jacoco/test/jacocoTestReport.xml"
    }
}